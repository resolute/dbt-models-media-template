version: 2

sources:
  - name: improvado
    database: green-post-223109
    schema: agency_4333
    loader: improvado
    loaded_at_field: TIMESTAMP(date)

    freshness:
      warn_after: {count: 2, period: day}
      error_after: {count: 7, period: day}
      filter: account_id IN UNNEST({{ var('facebook_ads_ids') }})

    tables:
      - name: facebook_ads_creative
        identifier: 'facebook_ads_creative_*'

      - name: facebook_ads_placements
        identifier: 'facebook_ads_placements_*'

      - name: facebook_campaign_month_reach
        identifier: 'facebook_campaign_month_reach_*'
        loaded_at_field: TIMESTAMP(end_date)

      - name: facebook_entity_ads
        identifier: 'facebook_entity_ads_*'
    
      - name: facebook_entity_adsets
        identifier: 'facebook_entity_adsets_*'

      - name: facebook_entity_campaigns
        identifier: 'facebook_entity_campaigns_*'
      
      - name: facebook_entity_creatives
        identifier: 'facebook_entity_creatives_*'